---
import { MarkdocRenderer } from "@/components/markdoc-renderer";
import { getAllPosts, getPost } from "@/data/post";
import PostLayout from "@/layouts/blog-post.astro";
import type { GetStaticPaths } from "astro";

export const getStaticPaths = (async () => {
	const posts = await getAllPosts();
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: { slug: post.slug },
	}));
}) satisfies GetStaticPaths;

const { slug } = Astro.props;
const post = await getPost(slug);

if (!post) {
	return Astro.redirect("/404");
}
---

<PostLayout post={post}>
	<MarkdocRenderer client:load content={post.renderedContent} />
</PostLayout>
