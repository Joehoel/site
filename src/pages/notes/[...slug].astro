---
import Note from "@/components/note/note.astro";
import { getAllNotes, getNote } from "@/data/post";
import PageLayout from "@/layouts/base.astro";
import type { GetStaticPaths } from "astro";

export const getStaticPaths = (async () => {
	const notes = await getAllNotes();
	return notes.map((note) => ({
		params: { slug: note.slug },
		props: { slug: note.slug },
	}));
}) satisfies GetStaticPaths;

const { slug } = Astro.props;
const note = await getNote(slug);

if (!note) {
	return Astro.redirect("/404");
}

const meta = {
	description:
		note.description || `Read about my note posted on: ${new Date(note.publishDate).toLocaleDateString()}`,
	title: note.title,
};
---

<PageLayout meta={meta}>
	<Note as="h1" note={note} />
</PageLayout>
